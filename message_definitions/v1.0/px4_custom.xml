<?xml version="1.0"?>
<mavlink>
  <!-- 包含 development.xml 作为基础 (development 已包含 common) -->
  <include>development.xml</include>

  <messages>
    <!-- 重新定义 SYS_STATUS 消息,只保留 5 个字段 -->
    <message id="1" name="SYS_STATUS">
      <description>Simplified system status with only timestamp and sensor bitmaps for PX4</description>

      <!-- 只保留 5 个字段 -->
      <field type="uint64_t" name="time_unix_usec" units="us">Unix timestamp (microseconds since UNIX epoch)</field>
      <field type="uint32_t" name="time_boot_ms" units="ms">Timestamp (milliseconds since system boot)</field>
      <field type="uint32_t" name="onboard_control_sensors_present" enum="MAV_SYS_STATUS_SENSOR" display="bitmask" print_format="0x%08x">Bitmap showing which onboard controllers and sensors are present. Value of 0: not present. Value of 1: present.</field>
      <field type="uint32_t" name="onboard_control_sensors_enabled" enum="MAV_SYS_STATUS_SENSOR" display="bitmask" print_format="0x%08x">Bitmap showing which onboard controllers and sensors are enabled:  Value of 0: not enabled. Value of 1: enabled.</field>
      <field type="uint32_t" name="onboard_control_sensors_health" enum="MAV_SYS_STATUS_SENSOR" display="bitmask" print_format="0x%08x">Bitmap showing which onboard controllers and sensors have an error (or are operational). Value of 0: error. Value of 1: healthy.</field>
    </message>

    <!-- 重新定义 GPS_RAW_INT 消息,只保留 9 个基础字段 -->
    <message id="24" name="GPS_RAW_INT">
      <description>Simplified GPS raw data with only essential fields for PX4</description>

      <!-- 只保留 9 个基础字段 (无 vel) -->
      <field type="uint64_t" name="time_usec" units="us">Timestamp (UNIX Epoch time or time since system boot)</field>
      <field type="uint8_t" name="fix_type" enum="GPS_FIX_TYPE">GPS fix type</field>
      <field type="int32_t" name="lat" units="degE7">Latitude (WGS84, EGM96 ellipsoid)</field>
      <field type="int32_t" name="lon" units="degE7">Longitude (WGS84, EGM96 ellipsoid)</field>
      <field type="int32_t" name="alt" units="mm">Altitude (MSL)</field>
      <field type="uint16_t" name="eph" invalid="UINT16_MAX">GPS HDOP horizontal dilution of position (unitless * 100)</field>
      <field type="uint16_t" name="epv" invalid="UINT16_MAX">GPS VDOP vertical dilution of position (unitless * 100)</field>
      <field type="uint16_t" name="cog" units="cdeg" invalid="UINT16_MAX">Course over ground in degrees * 100</field>
      <field type="uint8_t" name="satellites_visible" invalid="UINT8_MAX">Number of satellites visible</field>
    </message>

    <!-- 重新定义 VFR_HUD 消息,整合来自多个原始消息的字段 -->
    <message id="74" name="VFR_HUD">
      <description>Simplified VFR HUD data integrating fields from VFR_HUD (74), GLOBAL_POSITION_INT (33), WIND_COV (231), and MISSION_CURRENT (42) for PX4</description>

      <!-- 来自原始 VFR_HUD (74) 的 5 个字段 -->
      <field type="float" name="airspeed" units="m/s">Vehicle speed (CAS/IAS for fixed-wing, groundspeed for multirotor)</field>
      <field type="float" name="groundspeed" units="m/s">Current ground speed</field>
      <field type="int16_t" name="heading" units="deg">Current heading (0-360, 0=north)</field>
      <field type="uint16_t" name="throttle" units="%">Current throttle setting (0 to 100)</field>
      <field type="float" name="climb" units="m/s">Current climb rate</field>

      <!-- 来自 GLOBAL_POSITION_INT (33) -->
      <field type="int32_t" name="relative_alt" units="mm">Altitude above home</field>

      <!-- 来自 WIND_COV (231) 的 3 个风速字段 -->
      <field type="float" name="wind_x" units="m/s" invalid="NaN">Wind in North (NED) direction</field>
      <field type="float" name="wind_y" units="m/s" invalid="NaN">Wind in East (NED) direction</field>
      <field type="float" name="wind_z" units="m/s" invalid="NaN">Wind in down (NED) direction</field>

      <!-- 来自 MISSION_CURRENT (42) -->
      <field type="uint16_t" name="seq">Current mission sequence number</field>
    </message>

    <!-- 重新定义 SCALED_IMU 消息,移除 temperature 扩展字段 -->
    <message id="26" name="SCALED_IMU">
      <description>Simplified SCALED IMU readings for 9DOF sensor for PX4. Contains scaled accelerometer, gyroscope and magnetometer readings without temperature.</description>

      <!-- 时间戳 -->
      <field type="uint32_t" name="time_boot_ms" units="ms">Timestamp (time since system boot)</field>

      <!-- 加速度计 (已校准和缩放) -->
      <field type="int16_t" name="xacc" units="mG">X acceleration</field>
      <field type="int16_t" name="yacc" units="mG">Y acceleration</field>
      <field type="int16_t" name="zacc" units="mG">Z acceleration</field>

      <!-- 陀螺仪 (已校准和缩放) -->
      <field type="int16_t" name="xgyro" units="mrad/s">X angular speed</field>
      <field type="int16_t" name="ygyro" units="mrad/s">Y angular speed</field>
      <field type="int16_t" name="zgyro" units="mrad/s">Z angular speed</field>

      <!-- 磁力计 (已校准和缩放) -->
      <field type="int16_t" name="xmag" units="mgauss">X magnetic field</field>
      <field type="int16_t" name="ymag" units="mgauss">Y magnetic field</field>
      <field type="int16_t" name="zmag" units="mgauss">Z magnetic field</field>
    </message>

    <!-- 重新定义 HOME_POSITION 消息,简化为 3 字段版本 -->
    <message id="242" name="HOME_POSITION">
      <description>Simplified home position for PX4. Contains only the essential GPS coordinates.</description>

      <field type="int32_t" name="latitude" units="degE7">Latitude (WGS84)</field>
      <field type="int32_t" name="longitude" units="degE7">Longitude (WGS84)</field>
      <field type="int32_t" name="altitude" units="mm">Altitude (MSL). Positive for up.</field>
    </message>

    <!-- 重新定义 NAV_CONTROLLER_OUTPUT 消息,简化为 10 字段版本 -->
    <message id="62" name="NAV_CONTROLLER_OUTPUT">
      <description>Simplified navigation and position controller state for PX4. Includes desired attitude, position errors, and target position.</description>

      <!-- 姿态和导航 -->
      <field type="float" name="nav_roll" units="deg">Current desired roll</field>
      <field type="float" name="nav_pitch" units="deg">Current desired pitch</field>
      <field type="int16_t" name="nav_bearing" units="deg">Current desired heading</field>
      <field type="int16_t" name="target_bearing" units="deg">Bearing to current waypoint/target</field>
      <field type="uint16_t" name="wp_dist" units="m">Distance to active waypoint</field>

      <!-- 目标速度和高度 -->
      <field type="float" name="target_speed" units="m/s">Current desired target speed</field>
      <field type="float" name="target_alt_rel" units="m">Current desired target altitude relative to takeoff point</field>

      <!-- 目标位置 (移除 xtrack_error, 添加 lat) -->
      <field type="int32_t" name="lat" units="degE7">Current desired latitude</field>
      <field type="int32_t" name="lon" units="degE7">Current desired longitude</field>
      <field type="int32_t" name="alt" units="mm">Current desired altitude above MSL (Mean Sea Level)</field>
    </message>

    <!-- 重新定义 ATTITUDE 消息,合并 ATTITUDE (30) 和 ATTITUDE_QUATERNION (31) 的所有字段 -->
    <message id="30" name="ATTITUDE">
      <description>Combined attitude message integrating fields from ATTITUDE (30) and ATTITUDE_QUATERNION (31) for PX4. Includes both Euler angles and quaternion representation.</description>

      <!-- 来自原始 ATTITUDE (30) 的字段 -->
      <field type="uint32_t" name="time_boot_ms" units="ms">Timestamp (time since system boot)</field>
      <field type="float" name="roll" units="rad">Roll angle (-pi..+pi)</field>
      <field type="float" name="pitch" units="rad">Pitch angle (-pi..+pi)</field>
      <field type="float" name="yaw" units="rad">Yaw angle (-pi..+pi)</field>
      <field type="float" name="rollspeed" units="rad/s">Roll angular speed</field>
      <field type="float" name="pitchspeed" units="rad/s">Pitch angular speed</field>
      <field type="float" name="yawspeed" units="rad/s">Yaw angular speed</field>

      <!-- 来自 ATTITUDE_QUATERNION (31) 的四元数字段 -->
      <field type="float" name="q1">Quaternion component 1, w (1 in null-rotation)</field>
      <field type="float" name="q2">Quaternion component 2, x (0 in null-rotation)</field>
      <field type="float" name="q3">Quaternion component 3, y (0 in null-rotation)</field>
      <field type="float" name="q4">Quaternion component 4, z (0 in null-rotation)</field>

      <!-- 来自 ATTITUDE_QUATERNION (31) 的旋转偏移四元数 -->
      <field type="float[4]" name="repr_offset_q" invalid="[0]">Rotation offset quaternion for user display (w, x, y, z order, zero-rotation is [1, 0, 0, 0], send [0, 0, 0, 0] if not supported)</field>
    </message>

    <!-- 重新定义 BATTERY_STATUS 消息,简化为 6 字段版本 -->
    <message id="147" name="BATTERY_STATUS">
      <description>Simplified battery information for PX4. Contains only essential battery status fields.</description>

      <!-- 基础字段 -->
      <field type="uint8_t" name="id" instance="true">Battery ID</field>
      <field type="uint16_t[10]" name="voltages" units="mV" invalid="[UINT16_MAX]">Battery voltage of cells 1 to 10 (see voltages_ext for cells 11-14). Cells in this field above the valid cell count for this battery should have the UINT16_MAX value. If individual cell voltages are unknown or not measured for this battery, then the overall battery voltage should be filled in cell 0, with all others set to UINT16_MAX. If the voltage of the battery is greater than (UINT16_MAX - 1), then cell 0 should be set to (UINT16_MAX - 1), and cell 1 to the remaining voltage. This can be extended to multiple cells if the total voltage is greater than 2 * (UINT16_MAX - 1).</field>
      <field type="int16_t" name="current_battery" units="cA" invalid="-1">Battery current, -1: autopilot does not measure the current</field>
      <field type="int8_t" name="battery_remaining" units="%" invalid="-1">Remaining battery energy. Values: [0-100], -1: autopilot does not estimate the remaining battery.</field>
      <field type="int32_t" name="time_remaining" units="s" invalid="0">Remaining battery time, 0: autopilot does not provide remaining battery time estimate</field>
      <field type="uint8_t" name="charge_state" enum="MAV_BATTERY_CHARGE_STATE">State for extent of discharge, provided by autopilot for warning or external reactions</field>
    </message>

    <message id="22" name="PARAM_VALUE">
      <description>Emit the value of a onboard parameter. The inclusion of param_count and param_index in the message allows the recipient to keep track of received parameters and allows him to re-request missing parameters after a loss or timeout. The parameter microservice is documented at https://mavlink.io/en/services/parameter.html</description>
      <field type="char[16]" name="param_id">Onboard parameter id, terminated by NULL if the length is less than 16 human-readable chars and WITHOUT null termination (NULL) byte if the length is exactly 16 chars - applications have to provide 16+1 bytes storage if the ID is stored as string</field>
      <field type="float" name="param_value">Onboard parameter value</field>
      <field type="uint8_t" name="param_type" enum="MAV_PARAM_TYPE">Onboard parameter type.</field>
      <field type="uint16_t" name="param_count">Total number of onboard parameters</field>
      <field type="uint16_t" name="param_index">Index of this onboard parameter</field>
    </message>

    <!-- 在原始 MISSION_COUNT 消息中删除opaque_id字段 -->
    <message id="44" name="MISSION_COUNT">
      <description>This message is emitted as response to MISSION_REQUEST_LIST by the MAV and to initiate a write transaction. The GCS can then request the individual mission item based on the knowledge of the total number of waypoints.</description>
      <field type="uint8_t" name="target_system">System ID</field>
      <field type="uint8_t" name="target_component">Component ID</field>
      <field type="uint16_t" name="count">Number of mission items in the sequence</field>
      <extensions/>
      <field type="uint8_t" name="mission_type" enum="MAV_MISSION_TYPE">Mission type.</field>
      <!-- <field type="uint32_t" name="opaque_id" invalid="0">Id of current on-vehicle mission, fence, or rally point plan (on download from vehicle).
        This field is used when downloading a plan from a vehicle to a GCS.
        0 on upload to the vehicle from GCS.
        0 if plan ids are not supported.
        The current on-vehicle plan ids are streamed in `MISSION_CURRENT`, allowing a GCS to determine if any part of the plan has changed and needs to be re-uploaded.
        The ids are recalculated by the vehicle when any part of the on-vehicle plan changes (when a new plan is uploaded, the vehicle returns the new id to the GCS in MISSION_ACK).
      </field> -->
    </message>

    <!-- 在原始 MISSION_ACK 消息中删除opaque_id字段 -->
    <message id="47" name="MISSION_ACK">
      <description>Acknowledgment message during waypoint handling. The type field states if this message is a positive ack (type=0) or if an error happened (type=non-zero).</description>
      <field type="uint8_t" name="target_system">System ID</field>
      <field type="uint8_t" name="target_component">Component ID</field>
      <field type="uint8_t" name="type" enum="MAV_MISSION_RESULT">Mission result.</field>
      <extensions/>
      <field type="uint8_t" name="mission_type" enum="MAV_MISSION_TYPE">Mission type.</field>
      <!-- <field type="uint32_t" name="opaque_id" invalid="0">Id of new on-vehicle mission, fence, or rally point plan (on upload to vehicle).
        The id is calculated and returned by a vehicle when a new plan is uploaded by a GCS.
        The only requirement on the id is that it must change when there is any change to the on-vehicle plan type (there is no requirement that the id be globally unique).
        0 on download from the vehicle to the GCS (on download the ID is set in MISSION_COUNT).
        0 if plan ids are not supported.
        The current on-vehicle plan ids are streamed in `MISSION_CURRENT`, allowing a GCS to determine if any part of the plan has changed and needs to be re-uploaded.
      </field> -->
    </message>

    <message id="51" name="MISSION_REQUEST_INT">
      <description>Request the information of the mission item with the sequence number seq. The response of the system to this message should be a MISSION_ITEM_INT message. https://mavlink.io/en/services/mission.html</description>
      <field type="uint8_t" name="target_system">System ID</field>
      <field type="uint8_t" name="target_component">Component ID</field>
      <field type="uint16_t" name="seq">Sequence</field>
      <extensions/>
      <field type="uint8_t" name="mission_type" enum="MAV_MISSION_TYPE">Mission type.</field>
    </message>

    <message id="65" name="RC_CHANNELS">
      <description>The PPM values of the RC channels received. The standard PPM modulation is as follows: 1000 microseconds: 0%, 2000 microseconds: 100%.  A value of UINT16_MAX implies the channel is unused. Individual receivers/transmitters might violate this specification.</description>
      <field type="uint32_t" name="time_boot_ms" units="ms">Timestamp (time since system boot).</field>
      <field type="uint8_t" name="chancount">Total number of RC channels being received. This can be larger than 18, indicating that more channels are available but not given in this message. This value should be 0 when no RC channels are available.</field>
      <field type="uint16_t" name="chan1_raw" units="us" invalid="UINT16_MAX">RC channel 1 value.</field>
      <field type="uint16_t" name="chan2_raw" units="us" invalid="UINT16_MAX">RC channel 2 value.</field>
      <field type="uint16_t" name="chan3_raw" units="us" invalid="UINT16_MAX">RC channel 3 value.</field>
      <field type="uint16_t" name="chan4_raw" units="us" invalid="UINT16_MAX">RC channel 4 value.</field>
      <field type="uint16_t" name="chan5_raw" units="us" invalid="UINT16_MAX">RC channel 5 value.</field>
      <field type="uint16_t" name="chan6_raw" units="us" invalid="UINT16_MAX">RC channel 6 value.</field>
      <field type="uint16_t" name="chan7_raw" units="us" invalid="UINT16_MAX">RC channel 7 value.</field>
      <field type="uint16_t" name="chan8_raw" units="us" invalid="UINT16_MAX">RC channel 8 value.</field>
      <field type="uint16_t" name="chan9_raw" units="us" invalid="UINT16_MAX">RC channel 9 value.</field>
      <field type="uint16_t" name="chan10_raw" units="us" invalid="UINT16_MAX">RC channel 10 value.</field>
      <field type="uint16_t" name="chan11_raw" units="us" invalid="UINT16_MAX">RC channel 11 value.</field>
      <field type="uint16_t" name="chan12_raw" units="us" invalid="UINT16_MAX">RC channel 12 value.</field>
      <field type="uint16_t" name="chan13_raw" units="us" invalid="UINT16_MAX">RC channel 13 value.</field>
      <field type="uint16_t" name="chan14_raw" units="us" invalid="UINT16_MAX">RC channel 14 value.</field>
      <field type="uint16_t" name="chan15_raw" units="us" invalid="UINT16_MAX">RC channel 15 value.</field>
      <field type="uint16_t" name="chan16_raw" units="us" invalid="UINT16_MAX">RC channel 16 value.</field>
      <field type="uint16_t" name="chan17_raw" units="us" invalid="UINT16_MAX">RC channel 17 value.</field>
      <field type="uint16_t" name="chan18_raw" units="us" invalid="UINT16_MAX">RC channel 18 value.</field>
      <field type="uint8_t" name="rssi" invalid="UINT8_MAX">Receive signal strength indicator in device-dependent units/scale. Values: [0-254], UINT8_MAX: invalid/unknown.</field>
    </message>

    <message id="73" name="MISSION_ITEM_INT">
      <description>Message encoding a mission item. This message is emitted to announce
                the presence of a mission item and to set a mission item on the system. The mission item can be either in x, y, z meters (type: LOCAL) or x:lat, y:lon, z:altitude. Local frame is Z-down, right handed (NED), global frame is Z-up, right handed (ENU). NaN or INT32_MAX may be used in float/integer params (respectively) to indicate optional/default values (e.g. to use the component's current latitude, yaw rather than a specific value). See also https://mavlink.io/en/services/mission.html.</description>
      <field type="uint8_t" name="target_system">System ID</field>
      <field type="uint8_t" name="target_component">Component ID</field>
      <field type="uint16_t" name="seq">Waypoint ID (sequence number). Starts at zero. Increases monotonically for each waypoint, no gaps in the sequence (0,1,2,3,4).</field>
      <field type="uint8_t" name="frame" enum="MAV_FRAME">The coordinate system of the waypoint.</field>
      <field type="uint16_t" name="command" enum="MAV_CMD">The scheduled action for the waypoint.</field>
      <field type="uint8_t" name="current">false:0, true:1</field>
      <field type="uint8_t" name="autocontinue">Autocontinue to next waypoint. 0: false, 1: true. Set false to pause mission after the item completes.</field>
      <field type="float" name="param1">PARAM1, see MAV_CMD enum</field>
      <field type="float" name="param2">PARAM2, see MAV_CMD enum</field>
      <field type="float" name="param3">PARAM3, see MAV_CMD enum</field>
      <field type="float" name="param4">PARAM4, see MAV_CMD enum</field>
      <field type="int32_t" name="x">PARAM5 / local: x position in meters * 1e4, global: latitude in degrees * 10^7</field>
      <field type="int32_t" name="y">PARAM6 / y position: local: x position in meters * 1e4, global: longitude in degrees *10^7</field>
      <field type="float" name="z">PARAM7 / z position: global: altitude in meters (relative or absolute, depending on frame.</field>
      <extensions/>
      <field type="uint8_t" name="mission_type" enum="MAV_MISSION_TYPE">Mission type.</field>
    </message>

    <message id="253" name="STATUSTEXT">
      <description>Status text message. These messages are printed in yellow in the COMM console of QGroundControl. WARNING: They consume quite some bandwidth, so use only for important status and error messages. If implemented wisely, these messages are buffered on the MCU and sent only at a limited rate (e.g. 10 Hz).</description>
      <field type="uint8_t" name="severity" enum="MAV_SEVERITY">Severity of status. Relies on the definitions within RFC-5424.</field>
      <field type="char[50]" name="text">Status text message, without null termination character</field>
      <extensions/>
      <field type="uint16_t" name="id">Unique (opaque) identifier for this statustext message.  May be used to reassemble a logical long-statustext message from a sequence of chunks.  A value of zero indicates this is the only chunk in the sequence and the message can be emitted immediately.</field>
      <field type="uint8_t" name="chunk_seq">This chunk's sequence number; indexing is from zero.  Any null character in the text field is taken to mean this was the last chunk.</field>
    </message>

    <message id="266" name="LOGGING_DATA">
      <description>A message containing logged data (see also MAV_CMD_LOGGING_START)</description>
      <field type="uint8_t" name="target_system">system ID of the target</field>
      <field type="uint8_t" name="target_component">component ID of the target</field>
      <field type="uint16_t" name="sequence">sequence number (can wrap)</field>
      <field type="uint8_t" name="length" units="bytes">data length</field>
      <field type="uint8_t" name="first_message_offset" units="bytes" invalid="UINT8_MAX">offset into data where first message starts. This can be used for recovery, when a previous message got lost (set to UINT8_MAX if no start exists).</field>
      <field type="uint8_t[249]" name="data">logged data</field>
    </message>

    <message id="12918" name="OPEN_DRONE_ID_ARM_STATUS">
      <description>Transmitter (remote ID system) is enabled and ready to start sending location and other required information. This is streamed by transmitter. A flight controller uses it as a condition to arm.</description>
      <field type="uint8_t" name="status" enum="MAV_ODID_ARM_STATUS">Status level indicating if arming is allowed.</field>
      <field type="char[50]" name="error">Text error message, should be empty if status is good to arm. Fill with nulls in unused portion.</field>
    </message>

  </messages>
</mavlink>

